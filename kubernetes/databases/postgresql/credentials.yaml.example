# =============================================================================
# Secret PostgreSQL Credentials - EXEMPLE
# =============================================================================
# NE PAS COMMITER ce fichier avec des vrais mots de passe !
#
# Procedure :
#   1. Copier ce fichier et remplacer les valeurs
#   2. Chiffrer avec kubeseal
#   3. Commiter le SealedSecret resultant
#
# Commande :
#   kubectl create secret generic postgresql-credentials \
#     --namespace production \
#     --from-literal=POSTGRES_PASSWORD='VotreMotDePassePostgresForT!' \
#     --from-literal=POSTGRES_REPLICATION_PASSWORD='MotDePasseReplication!' \
#     --from-literal=POSTGRES_APP_PASSWORD='MotDePasseApp!' \
#     --from-literal=POSTGRES_READONLY_PASSWORD='MotDePasseReadOnly!' \
#     --dry-run=client -o yaml | \
#   kubeseal \
#     --controller-name=sealed-secrets-controller \
#     --controller-namespace=security \
#     --format yaml \
#     > kubernetes/secrets/postgresql-sealed-secret.yaml
# =============================================================================
apiVersion: v1
kind: Secret
metadata:
  name: postgresql-credentials
  namespace: production
  labels:
    app: postgresql
    app.kubernetes.io/name: postgresql
    app.kubernetes.io/component: credentials
type: Opaque
stringData:
  # Mot de passe superuser PostgreSQL
  POSTGRES_PASSWORD: "CHANGE_ME_postgres_password"
  # Mot de passe pour la replication Patroni
  POSTGRES_REPLICATION_PASSWORD: "CHANGE_ME_replication_password"
  # Mot de passe pour l'utilisateur applicatif (backend NestJS)
  POSTGRES_APP_PASSWORD: "CHANGE_ME_app_password"
  # Mot de passe pour l'utilisateur lecture seule (monitoring)
  POSTGRES_READONLY_PASSWORD: "CHANGE_ME_readonly_password"
  # URL de connexion complete pour le backend
  DATABASE_URL: "postgresql://saas_app:CHANGE_ME_app_password@postgresql-primary.production.svc:5432/saas_production?schema=app"
  # URL de connexion lecture seule
  DATABASE_READONLY_URL: "postgresql://saas_readonly:CHANGE_ME_readonly_password@postgresql-replica.production.svc:5432/saas_production?schema=app"
