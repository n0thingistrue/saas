# =============================================================================
# Secret S3 Credentials - EXEMPLE
# =============================================================================
# Credentials Hetzner Object Storage pour les backups WAL-G et Redis.
# Utilise par les CronJobs de backup et le sidecar WAL-G de PostgreSQL.
#
# Commande pour creer le SealedSecret :
#   kubectl create secret generic s3-credentials \
#     --namespace production \
#     --from-literal=AWS_ACCESS_KEY_ID='votre-access-key' \
#     --from-literal=AWS_SECRET_ACCESS_KEY='votre-secret-key' \
#     --from-literal=AWS_ENDPOINT='https://fsn1.your-objectstorage.com' \
#     --from-literal=S3_BUCKET='saas-backups-prod' \
#     --from-literal=WALG_S3_PREFIX='s3://saas-backups-prod/walg' \
#     --dry-run=client -o yaml | \
#   kubeseal \
#     --controller-name=sealed-secrets-controller \
#     --controller-namespace=security \
#     --format yaml \
#     > kubernetes/secrets/s3-sealed-secret.yaml
#
# IMPORTANT : Creer aussi dans le namespace 'backup' pour les CronJobs :
#   kubectl create secret generic s3-credentials --namespace backup ...
#   kubectl create secret generic postgresql-credentials --namespace backup ...
#   kubectl create secret generic redis-credentials --namespace backup ...
# =============================================================================
apiVersion: v1
kind: Secret
metadata:
  name: s3-credentials
  namespace: production
  labels:
    app: backup
    app.kubernetes.io/name: s3-credentials
    app.kubernetes.io/component: backup
type: Opaque
stringData:
  AWS_ACCESS_KEY_ID: "CHANGE_ME_access_key"
  AWS_SECRET_ACCESS_KEY: "CHANGE_ME_secret_key"
  AWS_ENDPOINT: "https://fsn1.your-objectstorage.com"
  S3_BUCKET: "saas-backups-prod"
  WALG_S3_PREFIX: "s3://saas-backups-prod/walg"
